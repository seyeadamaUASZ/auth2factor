node("master") {
  stage("Clone the project") {
    git branch: 'main', url: 'https://github.com/seyeadamaUASZ/auth2factor.git'
  }

  stage("Compilation") {
    bat "mvn clean install -DskipTests"
  }

  stage("run test") {
      bat "mvn test"
   }

    stage('Scan'){
         withSonarQubeEnv(installationName:'sq1'){
              bat 'mvn clean install -DskipTests org.sonarsource.scanner.maven:sonar-maven-plugin:3.9.0.2155:sonar -Dsonar.java.binaries=target/classes'
         }
     }

}